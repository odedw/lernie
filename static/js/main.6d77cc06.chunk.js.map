{"version":3,"sources":["config/parameterConfig.ts","engine/LFO.ts","engine/runHydra.ts","engine/streams.ts","config/LaunchControlXL.ts","engine/setupMidi.ts","engine/state/defaultSourceState.ts","engine/engine.ts","storage/fileUtils.ts","components/Hydra.tsx","components/Scope.tsx","App.tsx","reportWebVitals.ts","index.tsx","types/index.ts","types/source.ts","types/state.ts"],"names":["config","parameters","mod1","min","max","mod2","mod3","rotation","brightness","pixelate","scale","colorama","modulate","modulateRotate","modulateScale","repeatXY","blend","diff","feedback","selfModulate","sourceMods","SourceType","osc","noise","voronoi","screen","shape","allParameters","Object","keys","map","k","LFO","div","this","time","Math","sin","getValueGenerator","ss","p","lfos","value","valueRange","forEach","lfo","i","lfoValue","getValue","abs","audio","a","fft","getSource","sb","screenRatio","sourceType","contrast","getNoise","getVoronoi","initScreen","src","color","getScreen","rotate","PI","getShape","getOsc","runSource","s","sources","o","o1","o2","outputBufferByIndex","s0","s1","sourceBufferByIndex","ms","modSourceByIndex","obj","repeat","out","run","state","solid","o0","parameterValueChange$","lfoDestinationValueChange$","audioDestinationValueChange$","clearParameter$","sourceTypeChange$","loadPreset$","savePreset$","keyDown$","keyUp$","resetSource$","selectAudioBin$","cc","switchSource","note","reset","shift","lfo1","lfo2","presets","input","Input","create","isNoteMatch","e","name","octave","channel","defaultParams","defaultSourceMods","generateDefaultSourceState","primary","res","SourceState","engine","ranAudio","keyState","savePreset","bind","loadPreset","getSourceType","mapping","then","streams","merge","index","noteOn","pipe","filter","ccObservables","m","sourceIndex","flatMap","lfoIndex","parameter","destination","allKeys","some","find","noteOff","findIndex","setupMidi","subscribe","Number","SourceTypeValues","length","includes","defaultState","navigator","mediaDevices","getDisplayMedia","video","desktopStream","desktopSource","context","createMediaStreamSource","setSmooth","meyda","setSource","show","startsWith","random","key","cloneSourceState","rerun","preset","gsap","to","duration","data","dataStr","encodeURIComponent","downloadAnchorNode","document","createElement","setAttribute","body","appendChild","click","remove","downloadObjectAsJson","JSON","stringify","moment","format","file","Promise","resolve","reject","reader","FileReader","addEventListener","event","target","result","readAsText","loadFile","str","parse","err","console","error","catch","Hydra","require","Canvas","styled","canvas","canvasRef","useRef","useState","hasRun","setHasRun","useEffect","current","w","window","innerWidth","h","innerHeight","width","height","setResolution","id","ref","Container","Text","timers","Scope","enabled","text1","setText1","text2","setText2","useCallback","text","force","setText","clearTimeout","setTimeout","sub","toString","toFixed","floor","unsubscribe","className","FileDrop","App","scopeEnabled","setScopeEnabled","initialized","setInitialized","evt","toLowerCase","saveProject","getElementById","randomize","init","type","accept","onChange","files","loadProject","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","isNaN","generateZeroParametersRecord","record"],"mappings":"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","file":"static/js/main.6d77cc06.chunk.js","sourcesContent":["import { Parameter, SourceType } from '../types';\n\nexport type Range = {\n  min: number;\n  max: number;\n};\nexport type ParameterConfig = {\n  parameters: Record<Parameter, Range>;\n  sourceMods: Record<SourceType, Record<'mod1' | 'mod2' | 'mod3', Range>>;\n};\n\nexport const config: ParameterConfig = {\n  parameters: {\n    mod1: { min: 0, max: 80 },\n    mod2: { min: -0.5, max: 0.5 },\n    mod3: { min: 0, max: 10 },\n    rotation: { min: 0, max: 6.283185307179586 },\n    brightness: { min: -1, max: 1 },\n    pixelate: { min: 10, max: 1500 },\n    scale: { min: 0.5, max: 7 },\n    colorama: { min: -0.001, max: 1 },\n    modulate: { min: -1, max: 1 },\n    modulateRotate: { min: -10, max: 10 },\n    modulateScale: { min: -10, max: 10 },\n    repeatXY: { min: 1, max: 8 },\n    blend: { min: 0, max: 1 },\n    diff: { min: 0, max: 1 },\n    feedback: { min: 0, max: 1 },\n    selfModulate: { min: 0, max: 1 },\n  },\n  sourceMods: {\n    [SourceType.osc]: {\n      mod1: { min: 0, max: 100 },\n      mod2: { min: -1, max: 1 },\n      mod3: { min: 0, max: 6.3 },\n    },\n    [SourceType.noise]: {\n      mod1: { min: 0, max: 1 },\n      mod2: { min: 0, max: 0.5 },\n      mod3: { min: 0, max: 10 },\n    },\n    [SourceType.voronoi]: {\n      mod1: { min: 0, max: 80 },\n      mod2: { min: 0, max: 10 },\n      mod3: { min: 0, max: 20 },\n    },\n    [SourceType.screen]: {\n      mod1: { min: 0, max: 1 },\n      mod2: { min: 0, max: 1 },\n      mod3: { min: 0, max: 1 },\n    },\n    [SourceType.shape]: {\n      mod1: { min: 1, max: 20 },\n      mod2: { min: 0, max: 1 },\n      mod3: { min: -100, max: 100 },\n    },\n  },\n};\n\nexport const allParameters = Object.keys(config.parameters).map((k) => k as Parameter);\n","export class LFO {\n  div: number;\n  constructor(div: number = 1) {\n    this.div = div;\n  }\n\n  getValue(time: number) {\n    return (Math.sin(time / this.div) + 1) / 2; // 0 to 1\n  }\n}\n","import { SourceState, SourceType, HydraStream, State, Parameter, CallbackObject, SourceBuffer } from '../types';\nimport { LFO } from './LFO';\nimport { config } from '../config/parameterConfig';\n\n// eslint-disable-next-line\nfunction debug(val: number): number {\n  console.log(val);\n  return val;\n}\n\nfunction getValueGenerator(ss: SourceState, p: Parameter, lfos: LFO[]): (co: CallbackObject) => number {\n  return ({ time }) => {\n    let value = ss.parameters[p];\n    const valueRange = config.parameters[p].max - config.parameters[p].min;\n\n    lfos.forEach((lfo, i) => {\n      // add lfo\n      const lfoValue = ss.lfos[i][p] < 0 ? 1 - lfo.getValue(time) : lfo.getValue(time);\n      value += lfoValue * Math.abs(ss.lfos[i][p]) * valueRange;\n    });\n\n    // add audio\n    value += ss.audio[p] * valueRange * a.fft[0];\n\n    // clamp\n    value = Math.min(Math.max(config.parameters[p].min, value), config.parameters[p].max);\n    return value;\n  };\n}\n\nfunction getOsc(ss: SourceState, lfos: LFO[]): HydraStream {\n  return osc(\n    getValueGenerator(ss, 'mod1', lfos),\n    getValueGenerator(ss, 'mod2', lfos),\n    getValueGenerator(ss, 'mod3', lfos)\n  );\n  // .kaleid(() => ss.parameters.kaleid);\n}\n\nfunction getNoise(ss: SourceState, screenRatio: number, lfos: LFO[]): HydraStream {\n  return noise(80, getValueGenerator(ss, 'mod1', lfos))\n    .scale(1, 1, screenRatio)\n    .contrast(getValueGenerator(ss, 'mod2', lfos));\n  // .kaleid(getValueGenerator(ss, 'kaleid', lfo));\n}\n\nfunction getVoronoi(ss: SourceState, screenRatio: number, lfos: LFO[]): HydraStream {\n  return voronoi(100, getValueGenerator(ss, 'mod1', lfos), getValueGenerator(ss, 'mod2', lfos)).scale(\n    1,\n    1,\n    screenRatio\n  );\n  // .kaleid(getValueGenerator(ss, 'kaleid', lfo));\n}\n\nfunction getScreen(ss: SourceState, sb: SourceBuffer, screenRatio: number, lfos: LFO[]): HydraStream {\n  sb.initScreen();\n  return (\n    src(sb)\n      // .saturate(getValueGenerator(ss, 'mod2', lfo))\n      .color(\n        getValueGenerator(ss, 'mod1', lfos),\n        getValueGenerator(ss, 'mod2', lfos),\n        getValueGenerator(ss, 'mod3', lfos)\n      )\n  );\n}\n\nfunction getShape(ss: SourceState, screenRatio: number, lfos: LFO[]): HydraStream {\n  return shape(getValueGenerator(ss, 'mod1', lfos), getValueGenerator(ss, 'mod2', lfos))\n    .scale(1, 1, screenRatio)\n    .rotate(({ time }) => ((time * ss.parameters.mod3) % 360) * (Math.PI / 180));\n}\n\nfunction getSource(ss: SourceState, sb: SourceBuffer, screenRatio: number, lfos: LFO[]): HydraStream {\n  switch (ss.sourceType) {\n    case SourceType.noise:\n      return getNoise(ss, screenRatio, lfos);\n    case SourceType.voronoi:\n      return getVoronoi(ss, screenRatio, lfos);\n    case SourceType.screen:\n      return getScreen(ss, sb, screenRatio, lfos);\n    case SourceType.shape:\n      return getShape(ss, screenRatio, lfos);\n    default:\n      return getOsc(ss, lfos);\n  }\n}\n\nconst outputBufferByIndex = (i: number) => [o1, o2][i];\nconst modSourceByIndex = (i: number) => [o2, o1][i];\nconst sourceBufferByIndex = (i: number) => [s0, s1][i];\n\nexport function runSource(s: State, i: number, screenRatio: number, lfos: LFO[]) {\n  const ss = s.sources[i];\n  const o = outputBufferByIndex(i);\n  const sb = sourceBufferByIndex(i);\n  const ms = modSourceByIndex(i);\n\n  const source = getSource(ss, sb, screenRatio, lfos);\n  source\n    .blend(o, getValueGenerator(ss, 'feedback', lfos))\n    .rotate(getValueGenerator(ss, 'rotation', lfos), 0)\n    .pixelate(\n      (obj) => getValueGenerator(ss, 'pixelate', lfos)(obj) * screenRatio,\n      getValueGenerator(ss, 'pixelate', lfos)\n    )\n    .scale(getValueGenerator(ss, 'scale', lfos))\n    .colorama(getValueGenerator(ss, 'colorama', lfos))\n    .modulate(src(ms), getValueGenerator(ss, 'modulate', lfos))\n    .modulateRotate(\n      src(ms),\n      getValueGenerator(ss, 'modulateRotate', lfos),\n      getValueGenerator(ss, 'modulateRotate', lfos)\n    )\n    .modulateScale(src(ms), getValueGenerator(ss, 'modulateScale', lfos))\n    .modulate(o, getValueGenerator(ss, 'selfModulate', lfos))\n    .repeat(getValueGenerator(ss, 'repeatXY', lfos), getValueGenerator(ss, 'repeatXY', lfos))\n    .brightness(getValueGenerator(ss, 'brightness', lfos))\n    .out(o);\n}\nexport default function run(state: State, screenRatio: number, lfos: LFO[]) {\n  runSource(state, 0, screenRatio, lfos);\n  runSource(state, 1, screenRatio, lfos);\n\n  solid(0, 0, 0, 0)\n    .blend(src(o1), getValueGenerator(state.sources[0], 'blend', lfos))\n    .blend(src(o2), getValueGenerator(state.sources[1], 'blend', lfos))\n    .diff(solid(0, 0, 0, 0).blend(src(o1), getValueGenerator(state.sources[0], 'diff', lfos)))\n    .diff(solid(0, 0, 0, 0).blend(src(o2), getValueGenerator(state.sources[1], 'diff', lfos)))\n    .out(o0);\n}\n\nexport function runAudio() {\n  // @ts-ignore\n  navigator.mediaDevices.getDisplayMedia({ video: true, audio: true }).then((desktopStream) => {\n    // @ts-ignore\n    const desktopSource = a.context.createMediaStreamSource(desktopStream);\n    a.setSmooth(0.5);\n    // @ts-ignore\n    a.meyda.setSource(desktopSource);\n  });\n\n  a.show();\n}\n","import { Observable } from 'rxjs';\nimport { Parameter, SourceType } from '../types';\nimport { Key } from '../types/Keys';\n\nexport type ParameterValueChangeEvent = {\n  parameter: Parameter;\n  value: number;\n  sourceIndex: number;\n};\n\nexport type ClearParameterEvent = {\n  parameter: Parameter;\n  sourceIndex: number;\n  destination?: 'lfo1' | 'lfo2' | 'audio';\n};\n\nexport type AudioDestinationValueChange = ParameterValueChangeEvent;\n\nexport type LfoDestinationValueChange = ParameterValueChangeEvent & {\n  lfoIndex: number;\n};\n\nexport type SourceTypeChange = {\n  sourceIndex: number;\n  type: SourceType;\n};\n\nexport class Streams {\n  parameterValueChange$!: Observable<ParameterValueChangeEvent>;\n  lfoDestinationValueChange$!: Observable<LfoDestinationValueChange>;\n  audioDestinationValueChange$!: Observable<LfoDestinationValueChange>;\n  clearParameter$!: Observable<ClearParameterEvent>;\n  sourceTypeChange$!: Observable<number>;\n  loadPreset$!: Observable<number>;\n  savePreset$!: Observable<number>;\n  keyDown$!: Observable<Key>;\n  keyUp$!: Observable<Key>;\n  resetSource$!: Observable<number>;\n  selectAudioBin$!: Observable<number>;\n}\n\nexport default new Streams();\n","import { Mapping } from '../types';\n\nconst config: Mapping = {\n  sources: [\n    {\n      parameters: {\n        blend: { cc: 77 },\n        diff: { cc: 78 },\n        feedback: { cc: 79 },\n        selfModulate: { cc: 80 },\n        mod1: { cc: 13 },\n        mod2: { cc: 14 },\n        mod3: { cc: 15 },\n        brightness: { cc: 16 },\n        rotation: { cc: 29 },\n        pixelate: { cc: 30 },\n        scale: { cc: 31 },\n        colorama: { cc: 32 },\n        modulate: { cc: 49 },\n        modulateRotate: { cc: 50 },\n        modulateScale: { cc: 51 },\n        repeatXY: { cc: 52 },\n      },\n      switchSource: { note: 'F2' },\n      reset: { note: 'F#2' },\n    },\n    {\n      parameters: {\n        blend: { cc: 81 },\n        diff: { cc: 82 },\n        feedback: { cc: 83 },\n        selfModulate: { cc: 84 },\n        mod1: { cc: 17 },\n        mod2: { cc: 18 },\n        mod3: { cc: 19 },\n        brightness: { cc: 20 },\n        rotation: { cc: 33 },\n        pixelate: { cc: 34 },\n        scale: { cc: 35 },\n        colorama: { cc: 36 },\n        modulate: { cc: 53 },\n        modulateRotate: { cc: 54 },\n        modulateScale: { cc: 55 },\n        repeatXY: { cc: 56 },\n      },\n      switchSource: { note: 'A3' },\n      reset: { note: 'A#3' },\n    },\n  ],\n  keys: {\n    shift: { note: 'A7' },\n    lfo1: { note: 'B7' },\n    lfo2: { note: 'C8' },\n    audio: { note: 'A#7' },\n  },\n  presets: [\n    { note: 'C#5' },\n    { note: 'D5' },\n    { note: 'D#5' },\n    { note: 'E5' },\n    { note: 'F6' },\n    { note: 'F#6' },\n    { note: 'G6' },\n    { note: 'G#6' },\n  ],\n};\n\nexport default config;\n","import { Input } from 'rmidi';\nimport { config } from '../config/parameterConfig';\nimport { Parameter, SourceType } from '../types';\nimport mapping from '../config/LaunchControlXL';\nimport { merge } from 'rxjs';\nimport streams, { ClearParameterEvent, LfoDestinationValueChange, ParameterValueChangeEvent } from './streams';\nimport { filter, map } from 'rxjs/operators';\nimport { Key, KeyState } from '../types/Keys';\n\nlet input = Input.create('Launch Control XL');\n\nconst isNoteMatch = (p: { note: string; channel?: number }, e: { note: { name: any; octave: any }; channel: any }) =>\n  p.note === `${e.note.name}${e.note.octave}` && (!p.channel || p.channel === e.channel);\n\nexport function setupMidi(getSourceType: (i: number) => SourceType, keyState: KeyState): Promise<void> {\n  const allParameters = Object.keys(mapping.sources[0].parameters).map((k) => k as Parameter);\n\n  // listInputs();\n  return input.then((i) => {\n    // reset\n    streams.resetSource$ = merge(\n      ...mapping.sources.map((mapping, index) =>\n        i.noteOn(mapping.reset.note, mapping.reset.channel).pipe(\n          filter(() => !keyState.audio),\n          map(() => index)\n        )\n      )\n    );\n\n    streams.selectAudioBin$ = merge(\n      ...mapping.sources.map((mapping, index) =>\n        i.noteOn(mapping.reset.note, mapping.reset.channel).pipe(\n          filter(() => keyState.audio),\n          map(() => index)\n        )\n      )\n    );\n\n    // switchSource\n    streams.sourceTypeChange$ = merge(\n      ...mapping.sources.map((mapping, index) =>\n        i.noteOn(mapping.switchSource.note, mapping.switchSource.channel).pipe(map(() => index))\n      )\n    );\n    const ccObservables = mapping.sources\n      .map((m, sourceIndex) =>\n        allParameters.map((p) =>\n          i.cc(m.parameters[p].cc, m.parameters[p].channel).pipe(map((e) => ({ e, sourceIndex, p })))\n        )\n      )\n      .flatMap((a) => a);\n\n    // LFOs\n    streams.lfoDestinationValueChange$ = merge(\n      ...ccObservables.map((o) =>\n        o.pipe(\n          filter(() => (keyState.lfo1 || keyState.lfo2) && !keyState.shift),\n          map(({ e, sourceIndex, p }) => {\n            const lfoIndex = keyState.lfo1 ? 0 : 1;\n            // // send LFO to param\n            const value = -1 + (2 * e.value) / 127; // between -1 and 1\n            return { value, parameter: p, sourceIndex, lfoIndex } as LfoDestinationValueChange;\n          })\n        )\n      )\n    );\n\n    // Parameter change\n    streams.parameterValueChange$ = merge(\n      ...ccObservables.map((o) =>\n        o.pipe(\n          filter(() => !(keyState.lfo1 || keyState.lfo2 || keyState.audio || keyState.shift)),\n          map(({ e, sourceIndex, p }) => {\n            const { min, max } = // mod1/2/3 change between source types\n              p === 'mod1' || p === 'mod2' || p === 'mod3'\n                ? config.sourceMods[getSourceType(sourceIndex)][p]\n                : config.parameters[p];\n            const unit = (max - min) / 127;\n            const value = min + unit * e.value;\n            return { value, parameter: p, sourceIndex } as ParameterValueChangeEvent;\n          })\n        )\n      )\n    );\n\n    // Audio reactivity\n    streams.audioDestinationValueChange$ = merge(\n      ...ccObservables.map((o) =>\n        o.pipe(\n          filter(() => keyState.audio && !keyState.shift),\n          map(({ e, sourceIndex, p }) => {\n            const value = e.value / 127; // between 0 and 1\n            return { value, parameter: p, sourceIndex } as LfoDestinationValueChange;\n          })\n        )\n      )\n    );\n\n    // Clear parameter\n    streams.clearParameter$ = merge(\n      ...ccObservables.map((o) =>\n        o.pipe(\n          filter(() => keyState.shift),\n          map(({ sourceIndex, p }) => {\n            const destination = keyState.lfo1 ? 'lfo1' : keyState.lfo2 ? 'lfo2' : keyState.audio ? 'audio' : null;\n            return { parameter: p, sourceIndex, destination } as ClearParameterEvent;\n          })\n        )\n      )\n    );\n\n    const noteOn = i.noteOn();\n    const allKeys = Object.keys(mapping.keys).map((k) => k as Key);\n\n    streams.keyDown$ = noteOn.pipe(\n      filter((e) => allKeys.some((k) => isNoteMatch(mapping.keys[k], e))),\n      map((e) => allKeys.find((k) => isNoteMatch(mapping.keys[k], e))!)\n    );\n    streams.keyUp$ = i.noteOff().pipe(\n      filter((e) => allKeys.some((k) => isNoteMatch(mapping.keys[k], e))),\n      map((e) => allKeys.find((k) => isNoteMatch(mapping.keys[k], e))!)\n    );\n    streams.loadPreset$ = noteOn.pipe(\n      filter((e) => mapping.presets.some((p) => isNoteMatch(p, e))),\n      map((e) => mapping.presets.findIndex((p) => isNoteMatch(p, e)))\n    );\n    streams.savePreset$ = noteOn.pipe(\n      filter((e) => keyState.shift && mapping.presets.some((p) => isNoteMatch(p, e))),\n      map((e) => mapping.presets.findIndex((p) => isNoteMatch(p, e)))\n    );\n\n    // debug\n    // i.noteOn().subscribe((e) => {\n    //   console.log(`${e.note.name}${e.note.octave}`);\n    // });\n  });\n}\n","import { SourceState, SourceType } from '../../types';\nconst defaultParams = {\n  rotation: 0,\n  // kaleid: 1,\n  brightness: 0,\n  pixelate: 1500,\n  scale: 1,\n  colorama: 0,\n  modulate: 0,\n  modulateRotate: 0,\n  modulateScale: 0,\n  repeatXY: 1,\n  blend: 1,\n  diff: 0,\n  feedback: 0,\n  selfModulate: 0,\n};\nconst defaultSourceMods = {\n  [SourceType.osc]: {\n    mod1: 40,\n    mod2: 0,\n    mod3: 0,\n  },\n  [SourceType.noise]: {\n    mod1: 0,\n    mod2: 0.8,\n    mod3: 0,\n  },\n  [SourceType.voronoi]: {\n    mod1: 0,\n    mod2: 0,\n    mod3: 0,\n  },\n  [SourceType.screen]: {\n    mod1: 1,\n    mod2: 1,\n    mod3: 1,\n  },\n  [SourceType.shape]: {\n    mod1: 3,\n    mod2: 0.3,\n    mod3: 0,\n  },\n};\nexport const generateDefaultSourceState = (sourceType: SourceType, primary: boolean = true): SourceState => {\n  const res = new SourceState(\n    {\n      ...defaultSourceMods[sourceType],\n      ...defaultParams,\n    },\n    sourceType\n  );\n  res.parameters.blend = primary ? res.parameters.blend : 0;\n  return res;\n};\n","import gsap from 'gsap';\nimport moment from 'moment';\nimport { config, allParameters } from '../config/parameterConfig';\nimport { downloadObjectAsJson, loadFile } from '../storage';\nimport { Parameter, SourceState, SourceType, SourceTypeValues, State } from '../types';\nimport { LFO } from './LFO';\nimport run, { runAudio, runSource } from './runHydra';\nimport streams from './streams';\nimport { setupMidi } from './setupMidi';\nimport { generateDefaultSourceState } from './state/defaultSourceState';\nimport { KeyState } from '../types/Keys';\n\nexport class Engine {\n  state: State;\n  screenRatio: number = 1;\n  lfos = [new LFO(), new LFO(2)];\n  ranAudio = false;\n  keyState: KeyState = {\n    lfo1: false,\n    lfo2: false,\n    shift: false,\n    audio: false,\n  };\n\n  constructor() {\n    this.state = {\n      sources: [generateDefaultSourceState(SourceType.osc), generateDefaultSourceState(SourceType.osc, false)],\n      presets: [],\n    };\n    this.savePreset = this.savePreset.bind(this);\n    this.loadPreset = this.loadPreset.bind(this);\n  }\n  init(): Promise<any> {\n    return setupMidi((i) => this.state.sources[i].sourceType, this.keyState).then(() => {\n      // subscriptions\n      streams.savePreset$.subscribe((i) => this.savePreset(i));\n      streams.loadPreset$.subscribe((i) => this.loadPreset(i));\n      streams.sourceTypeChange$.subscribe((index) => {\n        const ss = this.state.sources[index];\n        ss.sourceType = ((Number(ss.sourceType) + 1) % SourceTypeValues.length) as SourceType;\n\n        const defaultParams = generateDefaultSourceState(ss.sourceType).parameters;\n        allParameters\n          .filter((p) => !['blend', 'diff'].includes(p))\n          .forEach((p) => (ss.parameters[p as Parameter] = defaultParams[p as Parameter]));\n        runSource(this.state, index, this.screenRatio, this.lfos);\n      });\n      streams.keyDown$.subscribe((e) => (this.keyState[e] = true));\n      streams.keyUp$.subscribe((e) => (this.keyState[e] = false));\n      streams.parameterValueChange$.subscribe(\n        (e) => (this.state.sources[e.sourceIndex].parameters[e.parameter] = e.value)\n      );\n      streams.lfoDestinationValueChange$.subscribe(\n        (e) => (this.state.sources[e.sourceIndex].lfos[e.lfoIndex][e.parameter] = e.value)\n      );\n      streams.audioDestinationValueChange$.subscribe(\n        (e) => (this.state.sources[e.sourceIndex].audio[e.parameter] = e.value)\n      );\n      streams.resetSource$.subscribe((index) => {\n        const ss = this.state.sources[index];\n        const defaultState = generateDefaultSourceState(ss.sourceType);\n        // copy parameters default state\n        allParameters.forEach((p) => {\n          ss.parameters[p] = defaultState.parameters[p];\n          ss.lfos.forEach((lfo) => (lfo[p] = 0));\n        });\n      });\n      streams.clearParameter$.subscribe((e) => {\n        const ss = this.state.sources[e.sourceIndex];\n        if (e.destination === 'lfo1') {\n          ss.lfos[0][e.parameter] = 0;\n        } else if (e.destination === 'lfo2') {\n          ss.lfos[1][e.parameter] = 0;\n        } else if (e.destination === 'audio') {\n          ss.audio[e.parameter] = 0;\n        } else {\n          ss.parameters[e.parameter] = generateDefaultSourceState(ss.sourceType).parameters[e.parameter];\n        }\n      });\n\n      streams.selectAudioBin$.subscribe((e) => {\n        if (!this.ranAudio) {\n          this.ranAudio = true;\n          runAudio();\n        }\n      });\n    });\n\n    // debug\n    // merge(\n    //   engine.scopeSubjects.sourceTypeChange,\n    //   engine.scopeSubjects.parameterChange,\n\n    //   engine.scopeSubjects.loadPreset,\n    //   engine.scopeSubjects.savePreset\n    // ).subscribe((e) => console.log(e));\n  }\n  run(screenRatio?: number) {\n    if (screenRatio) {\n      this.screenRatio = screenRatio;\n    }\n    run(this.state, this.screenRatio, this.lfos);\n  }\n  randomize() {\n    allParameters.forEach((k) => {\n      if (k.startsWith('modulate')) {\n        return;\n      }\n      if (Math.random() < 0.5) {\n        const key = k as Parameter;\n        this.state.sources[0].parameters[key] =\n          Math.random() * (config.parameters[key].max - config.parameters[key].min + 1) + config.parameters[key].min;\n        this.state.sources[1].parameters[key] =\n          Math.random() * (config.parameters[key].max - config.parameters[key].min + 1) + config.parameters[key].min;\n      }\n    });\n  }\n\n  savePreset(index: number) {\n    this.state.presets[index] = [\n      this.cloneSourceState(this.state.sources[0]),\n      this.cloneSourceState(this.state.sources[1]),\n    ];\n  }\n\n  loadPreset(index: number) {\n    if (!this.state.presets[index] || this.state.presets[index].length !== this.state.sources.length) {\n      return;\n    }\n    const rerun = this.state.presets[index].some((p, i) => p.sourceType !== this.state.sources[i].sourceType);\n    this.state.sources.forEach((s, i) => {\n      const preset = this.state.presets[index][i];\n      s.sourceType = preset.sourceType;\n      gsap.to(s.parameters, {\n        ...preset.parameters,\n        duration: 0.001,\n        repeat: 0,\n      });\n    });\n    if (rerun) {\n      run(this.state, this.screenRatio, this.lfos);\n    }\n  }\n\n  saveProject() {\n    downloadObjectAsJson(JSON.stringify(this.state, null, 2), moment().format('YYYY-MM-DD_hh-mm-ss'));\n  }\n\n  loadProject(file: File) {\n    loadFile(file)\n      .then((str) => {\n        try {\n          const state = JSON.parse(str) as State;\n          this.state = state;\n          run(this.state, this.screenRatio, this.lfos);\n        } catch (err) {\n          console.error('failed to parse file', err);\n        }\n      })\n      .catch((err) => {\n        console.error('failed to read file', err);\n      });\n  }\n\n  private cloneSourceState(s: SourceState): SourceState {\n    return new SourceState({ ...s.parameters }, s.sourceType);\n  }\n}\n\nexport const engine = new Engine();\n","export function loadFile(file: File): Promise<string> {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.addEventListener('load', (event) => {\n      resolve(event.target?.result as string);\n    });\n    reader.readAsText(file);\n  });\n}\n\nexport function downloadObjectAsJson(data: string, name: string) {\n  var dataStr = 'data:text/json;charset=utf-8,' + encodeURIComponent(data);\n  var downloadAnchorNode = document.createElement('a');\n  downloadAnchorNode.setAttribute('href', dataStr);\n  downloadAnchorNode.setAttribute('download', name + '.json');\n  document.body.appendChild(downloadAnchorNode); // required for firefox\n  downloadAnchorNode.click();\n  downloadAnchorNode.remove();\n}\n","import React, { useEffect, useRef, useState } from 'react';\nimport styled from 'styled-components';\nimport { engine } from '../engine';\nconst Hydra = require('hydra-synth');\n\nconst Canvas = styled.canvas`\n  height: 100%;\n  width: 100%;\n`;\n\nexport default () => {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const [hasRun, setHasRun] = useState(false);\n  useEffect(() => {\n    if (canvasRef.current && !hasRun) {\n      const w = window.innerWidth;\n      const h = window.innerHeight;\n      canvasRef.current.width = w;\n      canvasRef.current.height = h;\n      const hydra = new Hydra({\n        canvas: canvasRef.current,\n        // makeGlobal: false,\n        //   precision: 'highp',\n      });\n      hydra.setResolution(w, h);\n      engine.run(w / h);\n      setHasRun(false);\n    }\n  }, [canvasRef, hasRun]);\n\n  return <Canvas id=\"hydra-canvas\" ref={canvasRef} />;\n};\n","import React, { useCallback, useEffect, useState } from 'react';\nimport styled from 'styled-components';\nimport streams from '../engine/streams';\nimport { SourceType } from '../types';\nimport { merge } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { engine } from '../engine';\n\nconst Container = styled.div`\n  position: absolute;\n  left: 0;\n  right: 0;\n  text-align: center;\n  bottom: 20vh;\n  font-size: 5vh;\n  text-shadow: 2px 2px 2px #111;\n  // -webkit-text-stroke-width: 2px;\n  // -webkit-text-stroke-color: #111;\n\n  .text-1 {\n    color: #dcf;\n  }\n  .text-2 {\n    color: #dfc;\n  }\n`;\nconst Text = styled.div``;\nlet timers: NodeJS.Timeout[] = [];\ntype Props = {\n  enabled: boolean;\n};\nconst Scope: React.FC<Props> = ({ enabled }) => {\n  const [text1, setText1] = useState('');\n  const [text2, setText2] = useState('');\n  const show = useCallback(\n    (text: string, force: boolean = false) => {\n      const index = text.startsWith('2 - ') ? 1 : 0;\n      const setText = [setText1, setText2][index];\n\n      if (!enabled && !force) {\n        return;\n      }\n      setText(text);\n      if (timers[index]) {\n        clearTimeout(timers[index]);\n      }\n      timers[index] = setTimeout(() => {\n        setText('');\n      }, 1000);\n    },\n    [setText1, setText2, enabled]\n  );\n  useEffect(() => {\n    const sub = merge(\n      streams.sourceTypeChange$.pipe(\n        map(\n          (sourceIndex) => `${sourceIndex + 1} - ${SourceType[engine.state.sources[sourceIndex].sourceType].toString()}`\n        )\n      ),\n      streams.parameterValueChange$.pipe(map((e) => `${e.sourceIndex + 1} - ${e.parameter}: ${e.value.toFixed(2)}`)),\n      streams.lfoDestinationValueChange$.pipe(\n        map((e) => `${e.sourceIndex + 1} - LFO ${e.lfoIndex + 1} - ${e.parameter}: ${Math.floor(e.value * 100)}%`)\n      ),\n      streams.audioDestinationValueChange$.pipe(\n        map((e) => `${e.sourceIndex + 1} - Audio - ${e.parameter}: ${Math.floor(e.value * 100)}%`)\n      ),\n      streams.loadPreset$.pipe(map((i) => `Load preset ${i + 1}`)),\n      streams.savePreset$.pipe(map((i) => `Save preset ${i + 1}`)),\n      streams.clearParameter$.pipe(\n        map((e) => `${e.sourceIndex + 1} ${e.destination ? `- ${e.destination}` : ''}- ${e.parameter} cleared`)\n      )\n    ).subscribe(show);\n    return () => sub.unsubscribe();\n  }, [show]);\n  useEffect(() => {\n    show(`Scope ${enabled ? 'on' : 'off'}`, true);\n  }, [enabled, show]);\n  return (\n    <Container>\n      <Text className=\"text-1\">{text1}</Text>\n      <Text className=\"text-2\">{text2}</Text>\n    </Container>\n  );\n};\nexport default Scope;\n","import React, { ChangeEvent, useEffect, useState } from 'react';\nimport './App.css';\nimport Hydra from './components/Hydra';\nimport styled from 'styled-components';\nimport { engine } from './engine/engine';\nimport Scope from './components/Scope';\n\nconst Container = styled.div`\n  height: 100%;\n  width: 100%;\n  position: relative;\n`;\n\nfunction loadFile(evt: ChangeEvent<HTMLInputElement>) {\n  if (evt.target.files && evt.target.files?.length > 0) {\n    engine.loadProject(evt.target.files[0]);\n  }\n}\nconst FileDrop = styled.input`\n  display: none;\n`;\n\nfunction App() {\n  const [scopeEnabled, setScopeEnabled] = useState(true);\n  const [initialized, setInitialized] = useState(false);\n  useEffect(() => {\n    function keyPress(evt: KeyboardEvent) {\n      const k = evt.key.toLowerCase();\n      if (k === 's') {\n        engine.saveProject();\n      } else if (k === 'l') {\n        document.getElementById('file-selector')?.click();\n      } else if (k === 'r') {\n        engine.randomize();\n      } else if (k === 'i') {\n        setScopeEnabled((enabled) => !enabled);\n      }\n    }\n\n    window.addEventListener('keypress', keyPress);\n  }, [setScopeEnabled]);\n  useEffect(() => {\n    engine.init().then(() => setInitialized(true));\n  }, [setInitialized]);\n  if (!initialized) {\n    return null;\n  }\n  return (\n    <Container>\n      <Hydra />\n      <Scope enabled={scopeEnabled} />\n      <FileDrop type=\"file\" id=\"file-selector\" accept=\".json\" onChange={(e) => loadFile(e)} />\n    </Container>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","export * from './hydra';\nexport * from './source';\nexport * from './mapping';\nexport * from './state';\nexport * from './parameters';\n","export enum SourceType {\n  osc = 0,\n  noise,\n  voronoi,\n  shape,\n  screen,\n}\n\nexport const SourceTypeValues = Object.keys(SourceType).filter((k) => isNaN(Number(k)));\n","import { SourceType } from './source';\nimport { Parameter } from './parameters';\nimport { allParameters } from '../config/parameterConfig';\n\nexport class SourceState {\n  parameters!: Record<Parameter, number>;\n  sourceType!: SourceType;\n  lfos!: Record<Parameter, number>[];\n  audio!: Record<Parameter, number>;\n  constructor(parameters: Record<Parameter, number>, sourceType: SourceType) {\n    this.parameters = parameters;\n    this.sourceType = sourceType;\n    this.lfos = [this.generateZeroParametersRecord(), this.generateZeroParametersRecord()];\n    this.audio = this.generateZeroParametersRecord();\n  }\n\n  generateZeroParametersRecord() {\n    const record = { ...this.parameters };\n    allParameters.forEach((p) => (record[p] = 0));\n    return record;\n  }\n}\n\nexport type State = {\n  sources: SourceState[];\n  presets: SourceState[][];\n};\n"],"sourceRoot":""}